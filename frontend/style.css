/* ═══════════════════════════════════════════════════════
   NERV SYSTEM MONITOR — NGE Interface
   ═══════════════════════════════════════════════════════ */

@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

/* ─── Variables ─────────────────────────────────────── */
:root {
    --bg:         #0a0a0f;
    --green:      #1eff00;
    --cyan:       #00d9ff;
    --red:        #ff1a1a;
    --amber:      #ffcc00;
    --dim:        #4a95b2;
    --border:     #0d3344;
    --glow:       rgba(0, 200, 255, 0.4);
    --glow-sub:   rgba(0, 200, 255, 0.12);
    --panel-bg:   rgba(8, 12, 20, 0.97);
    --font:       'Share Tech Mono', 'Courier New', monospace;
}

/* ─── Reset ─────────────────────────────────────────── */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html, body {
    height: 100%;
    overflow: hidden;
}

body {
    font-family: var(--font);
    background: var(--bg);
    color: var(--cyan);
    letter-spacing: 0.03em;
    font-size: 15px;
}

/* ─── Scanlines ─────────────────────────────────────── */
#scanlines {
    position: fixed;
    inset: 0;
    background: repeating-linear-gradient(
        0deg,
        transparent,
        transparent 2px,
        rgba(0, 0, 0, 0.18) 2px,
        rgba(0, 0, 0, 0.18) 4px
    );
    pointer-events: none;
    z-index: 9999;
    opacity: 0.3;
    transition: opacity 0.8s ease-out;
}
#scanlines.boot-flash { opacity: 0.85; }

/* ─── App wrapper (full-screen grid) ────────────────── */
#app-wrapper {
    display: grid;
    grid-template-rows: 48px 1fr 50px;
    grid-template-areas:
        "topbar"
        "main"
        "bottombar";
    height: 100vh;
    padding: 8px;
    gap: 7px;
}

/* ─── Panel base ─────────────────────────────────────── */
.nge-panel {
    position: relative;
    background: var(--panel-bg);
    border: 1px solid var(--border);
    box-shadow:
        0 0 10px var(--glow-sub),
        inset 0 0 30px rgba(0, 217, 255, 0.015);
    padding: 20px 12px 10px;
    overflow: hidden;
}

/* Dot-grid background */
.nge-panel::before {
    content: '';
    position: absolute;
    inset: 0;
    background-image: radial-gradient(circle, rgba(0, 217, 255, 0.07) 1px, transparent 1px);
    background-size: 18px 18px;
    pointer-events: none;
    z-index: 0;
}

/* Corner bracket decoration */
.nge-panel::after {
    content: '';
    position: absolute;
    inset: 0;
    background:
        /* top-left */
        linear-gradient(var(--cyan), var(--cyan)) top    left  / 16px 1px no-repeat,
        linear-gradient(var(--cyan), var(--cyan)) top    left  / 1px 16px no-repeat,
        /* top-right */
        linear-gradient(var(--cyan), var(--cyan)) top    right / 16px 1px no-repeat,
        linear-gradient(var(--cyan), var(--cyan)) top    right / 1px 16px no-repeat,
        /* bottom-left */
        linear-gradient(var(--cyan), var(--cyan)) bottom left  / 16px 1px no-repeat,
        linear-gradient(var(--cyan), var(--cyan)) bottom left  / 1px 16px no-repeat,
        /* bottom-right */
        linear-gradient(var(--cyan), var(--cyan)) bottom right / 16px 1px no-repeat,
        linear-gradient(var(--cyan), var(--cyan)) bottom right / 1px 16px no-repeat;
    pointer-events: none;
    z-index: 1;
}

/* Panel contents sit above pseudo-elements */
.nge-panel > * { position: relative; z-index: 2; }

.panel-label {
    position: absolute;
    top: 5px;
    left: 10px;
    font-size: 11px;
    color: var(--dim);
    text-transform: uppercase;
    letter-spacing: 0.18em;
    z-index: 3;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: calc(100% - 20px);
}

/* ─── Typography helpers ─────────────────────────────── */
.dim-label {
    font-size: 11px;
    color: var(--dim);
    text-transform: uppercase;
    letter-spacing: 0.18em;
    line-height: 1.6;
}
.dim-text {
    font-size: 13px;
    color: var(--dim);
}
.no-data {
    color: var(--dim);
    font-size: 13px;
    padding: 16px;
    text-align: center;
}

/* Bracket value  [ XX ] */
.bracket-val {
    color: var(--green);
    font-size: 1.55rem;
    line-height: 1.1;
}
.bracket-val::before { content: '[ '; color: var(--dim); }
.bracket-val::after  { content: ' ]'; color: var(--dim); }

/* ─── Blink cursor ───────────────────────────────────── */
.blink-cursor {
    color: var(--green);
    animation: blink 1.2s step-end infinite;
    font-size: 0.9rem;
}
@keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

/* ─── Boot animations ────────────────────────────────── */
.boot-panel {
    opacity: 0;
    animation: panel-boot 0.45s ease-out forwards;
}
.boot-panel[data-boot-order="0"] { animation-delay: 0.05s; }
.boot-panel[data-boot-order="1"] { animation-delay: 0.22s; }
.boot-panel[data-boot-order="2"] { animation-delay: 0.40s; }
.boot-panel[data-boot-order="3"] { animation-delay: 0.58s; }
.boot-panel[data-boot-order="4"] { animation-delay: 0.76s; }

@keyframes panel-boot {
    from { opacity: 0; clip-path: inset(100% 0 0 0); }
    to   { opacity: 1; clip-path: inset(0%   0 0 0); }
}

/* ─── TOP BAR ────────────────────────────────────────── */
#top-bar {
    grid-area: topbar;
    animation: panel-boot 0.45s ease-out 0.05s forwards, bar-pulse 4s ease-in-out 1.5s infinite;
    padding: 12px 16px 8px;
}
@keyframes bar-pulse {
    0%, 100% { box-shadow: 0 0 10px var(--glow-sub); }
    50%       { box-shadow: 0 0 22px var(--glow), 0 0 3px var(--cyan); }
}

#top-inner {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 16px;
    height: 100%;
}

.top-group {
    display: flex;
    flex-direction: column;
    gap: 1px;
    flex-shrink: 0;
}
.top-value {
    color: var(--cyan);
    font-size: 0.9rem;
    letter-spacing: 0.06em;
}

#status-center {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
}
#system-status {
    font-size: 0.8rem;
    letter-spacing: 0.14em;
}
#system-status.status-nominal {
    color: var(--green);
    animation: status-pulse 3s ease-in-out infinite;
}
#system-status.status-error { color: var(--red); }

@keyframes status-pulse {
    0%, 100% { text-shadow: 0 0 6px var(--green); }
    50%       { text-shadow: 0 0 18px var(--green), 0 0 36px rgba(30,255,0,0.25); }
}

.top-controls {
    flex-direction: row;
    align-items: center;
    gap: 8px;
}
select, button {
    font-family: var(--font);
    background: rgba(0, 30, 50, 0.8);
    color: var(--cyan);
    border: 1px solid var(--border);
    padding: 3px 10px;
    cursor: pointer;
    font-size: 11px;
    letter-spacing: 0.08em;
    appearance: none;
    clip-path: polygon(4px 0%, 100% 0%, calc(100% - 4px) 100%, 0% 100%);
}
button:hover { background: rgba(0, 217, 255, 0.15); color: var(--green); }
select:focus, button:focus { outline: none; }

/* ─── MAIN LAYOUT ────────────────────────────────────── */
#main-layout {
    grid-area: main;
    display: grid;
    grid-template-columns: 310px 1fr 260px;
    gap: 7px;
    overflow: hidden;
    min-height: 0;
}

#left-col {
    display: flex;
    flex-direction: column;
    gap: 7px;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
}
#left-col::-webkit-scrollbar { width: 3px; }
#left-col::-webkit-scrollbar-thumb { background: var(--border); }

#center-col {
    overflow: hidden;
    display: flex;
    flex-direction: column;
    min-height: 0;
}
#right-col {
    overflow: hidden;
    display: flex;
    flex-direction: column;
    min-height: 0;
}

/* ─── CPU PANEL ──────────────────────────────────────── */
#cpu-panel { flex-shrink: 0; }

#cpu-body {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 8px;
}
#cpu-gauge-wrap {
    flex-shrink: 0;
    width: 148px;
    height: 106px;
}
#cpu-gauge-canvas {
    width: 148px;
    height: 106px;
    display: block;
}
#cpu-side {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 2px;
}
#cpu-side .bracket-val { font-size: 1.2rem; }

#cpu-waveform {
    width: 100%;
    height: 52px;
    display: block;
    margin-bottom: 4px;
}
.waveform-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

/* ─── RAM PANEL ──────────────────────────────────────── */
#ram-panel { flex-shrink: 0; }

#ram-header {
    display: flex;
    align-items: baseline;
    gap: 12px;
    margin-bottom: 8px;
}
#ram-header .bracket-val { font-size: 1.2rem; }

#ram-bar-wrap {
    display: flex;
    gap: 2px;
    margin-bottom: 4px;
}
.ram-seg {
    flex: 1;
    height: 16px;
    background: rgba(0, 40, 60, 0.5);
    border: 1px solid rgba(13, 51, 68, 0.6);
    transition: background 0.4s, box-shadow 0.4s;
}
.ram-seg.filled.seg-green {
    background: rgba(30, 255, 0, 0.75);
    border-color: var(--green);
    box-shadow: 0 0 4px rgba(30, 255, 0, 0.5);
}
.ram-seg.filled.seg-yellow {
    background: rgba(255, 200, 0, 0.75);
    border-color: var(--amber);
    box-shadow: 0 0 4px rgba(255, 200, 0, 0.5);
}
.ram-seg.filled.seg-red {
    background: rgba(255, 26, 26, 0.85);
    border-color: var(--red);
    box-shadow: 0 0 4px rgba(255, 26, 26, 0.6);
}
.bar-scale {
    display: flex;
    justify-content: space-between;
    font-size: 11px;
    color: var(--dim);
}

/* ─── DISK HEXAGONS ──────────────────────────────────── */
#disk-panel { flex-shrink: 0; }

#disk-hexes {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: center;
    align-items: flex-start;
    padding: 14px 0 4px;
}

.disk-hex {
    width: 96px;
    height: 110px;
    clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 22px 6px;
    transition: filter 0.3s;
    cursor: default;
}
/* Row 2+ hexes pull up to nest into the row above (honeycomb) */
.disk-hex:nth-child(n+3) { margin-top: -28px; position: relative; }
.disk-hex:hover { filter: brightness(1.25); }
/* backgrounds are set via inline gradient in JS */

.hex-mount {
    width: 100%;
    overflow: hidden;
    font-size: 0.75rem;
    color: var(--cyan);
    font-weight: bold;
    line-height: 1.2;
}
.hex-mount-text {
    display: inline-block;
    white-space: nowrap;
}
.hex-mount-text.scrolling {
    animation: hex-text-scroll 9s linear infinite;
}
@keyframes hex-text-scroll {
    0%, 15%   { transform: translateX(0); }       /* pause: show start of path */
    85%, 100% { transform: translateX(-100%); }   /* scroll off left, hold, then loop */
}
.hex-pct {
    font-size: 1.2rem;
    color: var(--green);
    line-height: 1.2;
    margin: 2px 0;
}
.hex-critical .hex-pct { color: var(--red); }
.hex-warn     .hex-pct { color: var(--amber); }
.hex-gb  { font-size: 0.65rem; color: var(--dim); line-height: 1.4; }
.hex-dev { font-size: 0.6rem;  color: var(--dim); width: 100%; overflow: hidden; }
.hex-smart-ok   { font-size: 0.6rem; color: var(--green); margin-top: 2px; }
.hex-smart-fail { font-size: 0.65rem; color: var(--red); margin-top: 2px; }

/* ─── DOCKER PANEL ───────────────────────────────────── */
#docker-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    padding-bottom: 8px;
}
#docker-list {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    padding: 4px 0;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
}
#docker-list::-webkit-scrollbar { width: 3px; }
#docker-list::-webkit-scrollbar-thumb { background: var(--border); }

.docker-bar {
    display: flex;
    align-items: center;
    height: 44px;
    margin: 3px 0;
    padding: 0 14px 0 14px;
    clip-path: polygon(8px 0%, 100% 0%, calc(100% - 8px) 100%, 0% 100%);
    gap: 8px;
    font-size: 13px;
    overflow: hidden;
    transition: filter 0.2s;
    background: rgba(15, 18, 28, 0.9);
    border-top: 1px solid var(--border);
    cursor: default;
}
.docker-bar:hover { filter: brightness(1.2); }

.docker-bar.status-running   { background: rgba(0, 40, 15, 0.9);  border-top-color: var(--green); }
.docker-bar.status-exited    { background: rgba(15, 22, 30, 0.9); border-top-color: var(--dim); }
.docker-bar.status-dead      { background: rgba(40, 5, 5, 0.9);   border-top-color: var(--red); }
.docker-bar.status-paused,
.docker-bar.status-restarting { background: rgba(38, 30, 0, 0.9); border-top-color: var(--amber); }

.docker-indicator {
    font-size: 0.8rem;
    flex-shrink: 0;
    width: 14px;
}
.status-running  .docker-indicator { color: var(--green); text-shadow: 0 0 6px var(--green); }
.status-dead     .docker-indicator { color: var(--red); }
.status-exited   .docker-indicator { color: var(--dim); }
.status-paused   .docker-indicator,
.status-restarting .docker-indicator { color: var(--amber); }

.docker-name {
    color: var(--cyan);
    font-size: 0.85rem;
    flex-shrink: 0;
    min-width: 100px;
    max-width: 150px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.docker-status-tag {
    font-size: 0.72rem;
    color: var(--dim);
    flex-shrink: 0;
    letter-spacing: 0.1em;
}
.docker-health {
    font-size: 0.68rem;
    padding: 1px 5px;
    flex-shrink: 0;
    border: 1px solid;
}
.health-healthy   { color: var(--green); border-color: var(--green); }
.health-unhealthy { color: var(--red);   border-color: var(--red); }
.health-starting  { color: var(--amber); border-color: var(--amber); }

.docker-stats-inline {
    flex: 1;
    overflow: hidden;
    min-width: 0;
    display: flex;
    align-items: center;
}
.docker-stats-scroll {
    display: inline-flex;
    gap: 10px;
    align-items: center;
    white-space: nowrap;
    animation: docker-ticker 12s linear infinite;
}
@keyframes docker-ticker {
    0%, 15%   { transform: translateX(0); }
    85%, 100% { transform: translateX(-100%); }
}
.d-stat {
    color: var(--dim);
    font-size: 0.72rem;
    white-space: nowrap;
    flex-shrink: 0;
}
.d-stat.warn { color: var(--amber); }

/* ─── PROCESS PANEL ──────────────────────────────────── */
#process-panel {
    flex: 1;
    display: flex;
    flex-direction: column;
    min-height: 0;
    padding-bottom: 8px;
}
#process-list {
    flex: 1;
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: thin;
    scrollbar-color: var(--border) transparent;
}
#process-list::-webkit-scrollbar { width: 3px; }
#process-list::-webkit-scrollbar-thumb { background: var(--border); }

.proc-header {
    display: grid;
    grid-template-columns: 52px 1fr 54px 40px;
    padding: 4px 10px 6px;
    font-size: 11px;
    color: var(--dim);
    border-bottom: 1px solid var(--border);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    gap: 4px;
}
.proc-row {
    display: grid;
    grid-template-columns: 52px 1fr 54px 40px;
    padding: 5px 10px;
    font-size: 13px;
    border-bottom: 1px solid rgba(13, 51, 68, 0.3);
    transition: background 0.15s;
    gap: 4px;
    cursor: default;
}
.proc-row:hover    { background: rgba(0, 217, 255, 0.04); }
.proc-row.proc-high { background: rgba(255, 26, 26, 0.04); }

.proc-pid  { color: var(--dim); font-size: 12px; }
.proc-name {
    color: var(--cyan);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.proc-mem  { color: var(--green); text-align: right; }
.proc-pct  { color: var(--dim);   text-align: right; font-size: 12px; }

/* ─── BOTTOM BAR ─────────────────────────────────────── */
#bottom-bar {
    grid-area: bottombar;
    display: flex;
    align-items: center;
    padding: 6px 12px;
    gap: 12px;
}

#magi-block {
    display: flex;
    gap: 6px;
    flex-shrink: 0;
}
.magi-unit {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 2px 10px;
    border: 1px solid var(--border);
    min-width: 84px;
    background: rgba(0, 20, 30, 0.6);
    clip-path: polygon(4px 0%, 100% 0%, calc(100% - 4px) 100%, 0% 100%);
}
.magi-name {
    font-size: 10px;
    color: var(--dim);
    letter-spacing: 0.16em;
    text-transform: uppercase;
}
.magi-status {
    font-size: 0.95rem;
    color: var(--green);
    text-shadow: 0 0 8px var(--green);
    letter-spacing: 0.1em;
}

#hex-strip {
    flex: 1;
    overflow: hidden;
    display: flex;
    align-items: center;
    border-left: 1px solid var(--border);
    border-right: 1px solid var(--border);
    padding: 0 8px;
    height: 100%;
}
#hex-scroll {
    font-size: 11px;
    color: var(--dim);
    white-space: nowrap;
    animation: scroll-left 80s linear infinite;
    letter-spacing: 0.08em;
}
@keyframes scroll-left {
    from { transform: translateX(20%); }
    to   { transform: translateX(-100%); }
}

#bottom-right {
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    gap: 1px;
    text-align: right;
    min-width: 130px;
}
